/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
!function(){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal;var e=window.jQuery;"undefined"!=typeof e&&(e.extend(e.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor not yet initialized, use ckeditor() with callback.";return e},ckeditor:function(t,r){if(!CKEDITOR.env.isCompatible)return this;if(!e.isFunction(t)){var n=r;r=t,t=n}return r=r||{},this.filter("textarea, div, p").each(function(){var n=e(this),i=n.data("ckeditorInstance"),o=n.data("_ckeditorInstanceLock"),a=this;i&&!o?t&&t.apply(i,[this]):o?CKEDITOR.on("instanceReady",function(e){var r=e.editor;setTimeout(function(){return r.element?void(r.element.$==a&&t&&t.apply(r,[a])):void setTimeout(arguments.callee,100)},0)},null,null,9999):((r.autoUpdateElement||"undefined"==typeof r.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(r.autoUpdateElementJquery=!0),r.autoUpdateElement=!1,n.data("_ckeditorInstanceLock",!0),i=CKEDITOR.replace(a,r),n.data("ckeditorInstance",i),i.on("instanceReady",function(e){var r=e.editor;setTimeout(function(){if(!r.element)return void setTimeout(arguments.callee,100);if(e.removeListener("instanceReady",this.callee),r.on("dataReady",function(){n.trigger("setData.ckeditor",[r])}),r.on("getData",function(e){n.trigger("getData.ckeditor",[r,e.data])},999),r.on("destroy",function(){n.trigger("destroy.ckeditor",[r])}),r.config.autoUpdateElementJquery&&n.is("textarea")&&n.parents("form").length){var i=function(){n.ckeditor(function(){r.updateElement()})};n.parents("form").submit(i),n.parents("form").bind("form-pre-serialize",i),n.bind("destroy.ckeditor",function(){n.parents("form").unbind("submit",i),n.parents("form").unbind("form-pre-serialize",i)})}r.on("destroy",function(){n.data("ckeditorInstance",null)}),n.data("_ckeditorInstanceLock",null),n.trigger("instanceReady.ckeditor",[r]),t&&t.apply(r,[a])},0)},null,null,9999))}),this}}),CKEDITOR.config.jqueryOverrideVal&&(e.fn.val=CKEDITOR.tools.override(e.fn.val,function(t){return function(r,n){var i,o="undefined"!=typeof r;return this.each(function(){var a=e(this),s=a.data("ckeditorInstance");if(!n&&a.is("textarea")&&s){if(!o)return i=s.getData(),null;s.setData(r)}else{if(!o)return i=t.call(a),null;t.call(a,r)}return!0}),o?this:i}})))}();